(function(){$.widget("execut.HandlersButton",{_gridEl:null,_create:function(){var a=this;a._initElements();a._initEvents()},_initElements:function(){var a=this,b=a.element;a._gridEl=$(a.options.gridSelector);a._modalEl=$("#"+b.attr("id")+"-modal")},_initEvents:function(){var a=this,b=a.element;b.click(function(){if(b.attr("disabled")){return false}var c=a._gridEl.yiiGridView("getSelectedRows"),f=a._getMessage(c.length||a.options.totalCount);b.attr("disabled",true);if(confirm(f)){var d=a.options.url;if(d.search("\\?")==-1){d+="?"}for(var e=0;e<c.length;e++){d+="&"+a.options.idAttribute+"[]="+c[e]}$.get(d,function(m){var l="";if(typeof m==="string"){l=m}else{var g=[];for(var i in m){for(var k in m[i]){for(var h in m[i][k]){var j=m[i][k][h];g[g.length]=i+": "+j}}}l=g.join("<br>")}a._setModalContent(l)}).fail(function(g){if(g.status==302||g.status==301){return}a._setModalContent("Произошла ошибка №"+g.status+": "+g.responseText)})}else{b.attr("disabled",false)}})},_getMessage:function(a){var b=this,c=b.element;return b.options.confirmMessage.replace("#",a)},_setModalContent:function(c){var a=this,b=a.element;a._modalEl.find(".modal-body").html(c);a._modalEl.modal("show");b.attr("disabled",false)}})})();