(function(){$.widget("execut.HandlersButton",{_gridEl:null,_create:function(){var b=this;b._initElements();b._initEvents()},_initElements:function(){var d=this,c=d.element;d._gridEl=$(d.options.gridSelector);d._modalEl=$("#"+c.attr("id")+"-modal")},_initEvents:function(){var d=this,c=d.element;c.click(function(){if(c.attr("disabled")){return false}var h=d._gridEl.yiiGridView("getSelectedRows"),a=d._getMessage(h.length||d.options.totalCount);c.attr("disabled",true);if(confirm(a)){var g=d.options.url;if(g.search("\\?")==-1){g+="?"}for(var b=0;b<h.length;b++){g+="&"+d.options.idAttribute+"[]="+h[b]}$.get(g,function(e){var f="";if(typeof e==="string"){f=e}else{var r=[];for(var p in e){for(var n in e[p]){for(var q in e[p][n]){var o=e[p][n][q];r[r.length]=p+": "+o}}}f=r.join("<br>")}d._setModalContent(f)}).fail(function(e){if(e.status==302||e.status==301){return}d._setModalContent("Произошла ошибка №"+e.status+": "+e.responseText)})}else{c.attr("disabled",false)}})},_getMessage:function(e){var d=this,f=d.element;return d.options.confirmMessage.replace("#",e)},_setModalContent:function(f){var e=this,d=e.element;e._modalEl.find(".modal-body").html(f);e._modalEl.modal("show");d.attr("disabled",false)}})})();