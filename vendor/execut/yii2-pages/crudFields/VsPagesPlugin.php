<?php
/**
 */

namespace execut\pages\crudFields;
use execut\crudFields\fields\HasManyMultipleInput;
use execut\crudFields\fields\HasManySelect2;
use execut\pages\models\Page;
use yii\helpers\Inflector;

class VsPagesPlugin extends \execut\crudFields\Plugin
{
    public $linkAttribute = null;
    public $vsModelClass = null;
    public function getFields() {

        return [
            [
                'class' => HasManySelect2::class,
                'attribute' => 'pages',
                'relation' => 'pages',
                'module' => 'pages',
                'url' => [
                    '/pages/backend'
                ],
            ],
        ];
    }
    
    public function getRelations()
    {
        return [
            'pages' => [
               'class' => Page::class,
               'name' => 'pages',
               'link' => [
                   'id' => 'pages_page_id',
               ],
                'via' => 'vsPages',
                'multiple' => true
            ],
            'vsPages' => [
                'class' => $this->vsModelClass,
                'name' => 'vsPages',
                'link' => [
                    $this->linkAttribute => 'id',
                ],
                'multiple' => true
            ],
        ]; // TODO: Change the autogenerated stub
    }

    protected function getOwnerTableName() {
        return $this->owner->tableName();
    }

    protected function getOwnerForeignKey() {
        $tableName = $this->getOwnerTableName();

        return Inflector::singularize($tableName) . '_id';
    }
}